<!--pages/search/search.wxml-->
<view class="page">
  <!-- 搜索栏 -->
  <view class="search-bar">
    <view class="search-input-wrap">
      <image src="/images/search.png" class="search-icon"></image>
      <input 
        class="search-input"
        type="text"
        placeholder="搜索乡村文化..."
        value="{{keyword}}"
        bindinput="onInput"
        bindconfirm="onSearch"
        confirm-type="search"
        focus="true"
      />
      <image 
        wx:if="{{keyword}}" 
        src="/images/eye.png" 
        class="clear-icon"
        bindtap="clearKeyword"
      ></image>
    </view>
    <text class="cancel-btn" bindtap="cancelSearch">取消</text>
  </view>

  <!-- 搜索历史 -->
  <view wx:if="{{!showResults && historyList.length > 0}}" class="history-section">
    <view class="section-header">
      <text class="section-title">搜索历史</text>
      <text class="clear-all" bindtap="clearHistory">清空</text>
    </view>
    <view class="history-list">
      <text 
        class="history-item" 
        wx:for="{{historyList}}" 
        wx:key="index"
        bindtap="searchHistory"
        data-keyword="{{item}}"
      >{{item}}</text>
    </view>
  </view>

  <!-- 热门搜索 -->
  <view wx:if="{{!showResults}}" class="hot-section">
    <view class="section-header">
      <text class="section-title">热门搜索</text>
    </view>
    <view class="hot-list">
      <text 
        class="hot-item" 
        wx:for="{{hotKeywords}}" 
        wx:key="index"
        bindtap="searchHot"
        data-keyword="{{item}}"
      >{{item}}</text>
    </view>
  </view>

  <!-- 搜索结果 -->
  <view wx:if="{{showResults}}" class="results-section">
    <view wx:if="{{results.length > 0}}">
      <view class="result-count">找到 {{results.length}} 个相关结果</view>
      <view class="result-list">
        <view 
          class="result-item" 
          wx:for="{{results}}" 
          wx:key="id"
          bindtap="goToDetail"
          data-item="{{item}}"
        >
          <image src="{{item.image}}" class="result-image" mode="aspectFill"></image>
          <view class="result-info">
            <text class="result-name">{{item.name}}</text>
            <text class="result-category">{{item.category}}</text>
            <view class="result-stats">
              <text class="stat-text">{{item.viewCount}} 浏览</text>
              <text class="stat-text">{{item.likeCount}} 点赞</text>
            </view>
          </view>
        </view>
      </view>
    </view>
    
    <!-- 无结果 -->
    <view wx:if="{{results.length === 0 && !loading}}" class="empty">
      <image src="/images/class_black.png" class="empty-icon"></image>
      <text class="empty-text">未找到相关内容</text>
      <text class="empty-tip">换个关键词试试吧</text>
    </view>
  </view>

  <!-- 加载状态 -->
  <view wx:if="{{loading}}" class="loading">
    <text>搜索中...</text>
  </view>
</view>
