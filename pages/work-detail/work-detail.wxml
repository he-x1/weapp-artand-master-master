<!--pages/work-detail/work-detail.wxml-->
<view class="page">
  <!-- 轮播图区域 -->
  <swiper
    class="banner-swiper"
    indicator-dots="{{swipers.length > 1}}"
    autoplay="{{swipers.length > 1}}"
    interval="4000"
    duration="600"
  >
    <block wx:for="{{swipers}}" wx:key="id">
      <swiper-item>
        <image
          src="{{item.url}}"
          class="slide-image"
          mode="aspectFill"
          bindtap="previewImage"
          binderror="onSwiperImageError"
          data-url="{{item.url}}"
          data-index="{{index}}"
        />
      </swiper-item>
    </block>
  </swiper>

  <!-- 内容信息 -->
  <view class="content-section">
    <view class="content-header">
      <text class="content-title">{{work.name}}</text>
      <view class="content-meta">
        <text class="meta-item" wx:if="{{work.origin}}">产地：{{work.origin}}</text>
        <text class="meta-item" wx:if="{{work.heritageLevel}}">级别：{{work.heritageLevel}}</text>
      </view>
    </view>

    <!-- 统计信息 -->
    <view class="stats-bar">
      <view class="stat">
        <image src="/images/see.png" class="stat-icon"></image>
        <text>{{work.viewCount || 0}} 浏览</text>
      </view>
      <view class="stat">
        <image src="/images/love.png" class="stat-icon"></image>
        <text>{{likeCount}} 点赞</text>
      </view>
      <view class="stat">
        <image src="/images/collect.png" class="stat-icon"></image>
        <text>{{collectCount}} 收藏</text>
      </view>
    </view>

    <!-- 分类信息 -->
    <view class="info-item" wx:if="{{work.category}}">
      <text class="info-label">分类：</text>
      <text class="info-value">{{work.category}}</text>
    </view>

    <!-- 摘要 -->
    <view class="summary-section" wx:if="{{work.summary}}">
      <text class="summary-title">内容摘要</text>
      <text class="summary-content">{{work.summary}}</text>
    </view>

    <!-- 详细介绍 -->
    <view class="intro-section">
      <text class="intro-title">详细介绍</text>
      <text class="intro-content">{{work.description}}</text>
    </view>

    <!-- 相关推荐 -->
    <view class="related-section" wx:if="{{relatedList.length > 0}}">
      <text class="related-title">相关推荐</text>
      <scroll-view class="related-list" scroll-x>
        <view class="related-item-wrapper">
          <view
            class="related-item"
            wx:for="{{relatedList}}"
            wx:key="id"
            bindtap="goToDetail"
            data-item="{{item}}"
          >
            <image
              src="{{item.image || defaultImage}}"
              class="related-image"
              mode="aspectFill"
              binderror="onRelatedImageError"
              data-index="{{index}}"
            ></image>
            <text class="related-name">{{item.name}}</text>
          </view>
        </view>
      </scroll-view>
    </view>
  </view>

  <!-- 底部操作栏 -->
  <view class="fixed-operation-bar">
    <button
      class="action-btn {{isLiked ? 'active' : ''}}"
      bindtap="handleLike"
    >
      <image
        src="{{isLiked ? '/images/loved.png' : '/images/love.png'}}"
        class="action-icon"
      ></image>
      <text>{{isLiked ? '已点赞' : '点赞'}}</text>
    </button>
    <button
      class="action-btn {{isCollected ? 'active' : ''}}"
      bindtap="handleCollect"
    >
      <image
        src="{{isCollected ? '/images/collected.png' : '/images/collect.png'}}"
        class="action-icon"
      ></image>
      <text>{{isCollected ? '已收藏' : '收藏'}}</text>
    </button>
    <button class="action-btn" open-type="share">
      <image src="/images/share.png" class="action-icon" mode="aspectFit"></image>
      <text>分享</text>
    </button>
  </view>
</view>
